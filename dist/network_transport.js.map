{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap d5f7ab7b99e496220b81","webpack:///external {\"commonjs\":\"msgpack-lite\",\"commonjs2\":\"msgpack-lite\",\"amd\":\"msgpack-lite\",\"root\":\"msgpack\"}","webpack:///external {\"commonjs\":\"pure-uuid\",\"commonjs2\":\"pure-uuid\",\"amd\":\"pure-uuid\",\"root\":\"UUID\"}","webpack:///./src/index.js"],"names":["DependencyError","Error","APIError","window","WebSocket","eval","client","XMLHttpRequest","console","document","undefined","send_data_to_subscribers","socket_subject_map","stream","data","i","length","next","return_http_response","event","callback","request_response","request_response_code","target","status","JSON","parse","response","e","SyntaxError","error","init_socket","ws_url","socket_connection","self","socket","binaryType","onmessage","ev","decoded_response","decode","Uint8Array","log","payload","stringify","response_status","request_id","router","subject_map","onopen","in_progress","element","queue","shift","socket_send","message","queue_and_reconnect","format","Date","getTime","readyState","CONNECTING","CLOSED","push","send","encode","http_transport_func","protocol_prefix","method","api_url","endpoint","id","custom_method","query_params","headers","with_credentials","request","id_block","encodeURIComponent","custom_method_block","query_param_block","Object","query_param","slice","url","open","setRequestHeader","header","withCredentials","onload","onerror","onabort","ontimeout","ws_transport_func","transport_funcs","prototype","constructor","apply","concat","Array","call","arguments","transport_types","NetworkTransport","transports","garbage_collect_timeout","indexOf","ws_index","splice","warn","wss_index","garbage_collect","transport","socket_subject","now","setTimeout","name","cookie","nameEQ","ca","split","c","charAt","substring","Library","_name"],"mappings":"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","file":"network_transport.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"msgpack-lite\"), require(\"pure-uuid\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"network_transport\", [\"msgpack-lite\", \"pure-uuid\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"network_transport\"] = factory(require(\"msgpack-lite\"), require(\"pure-uuid\"));\n\telse\n\t\troot[\"network_transport\"] = factory(root[\"msgpack\"], root[\"UUID\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d5f7ab7b99e496220b81","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"msgpack-lite\",\"commonjs2\":\"msgpack-lite\",\"amd\":\"msgpack-lite\",\"root\":\"msgpack\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"pure-uuid\",\"commonjs2\":\"pure-uuid\",\"amd\":\"pure-uuid\",\"root\":\"UUID\"}\n// module id = 1\n// module chunks = 0","/*\nWebpack library starter\nThe MIT License (MIT)\n\nCopyright (c) 2015 Krasimir Tsonev\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n*/\n\nexport class DependencyError extends Error {};\nexport class APIError extends Error {};\n\nimport msgpack from 'msgpack';\nimport UUID from 'UUID';\n\nif(typeof window === \"undefined\"){\n    if(typeof WebSocket === \"undefined\"){\n        let WebSocket = eval('require(\\'websocket\\')').client;\n    }\n\n    if(typeof XMLHttpRequest === \"undefined\"){\n        let XMLHttpRequest = eval('require(\\'xmlhttprequest\\')').XMLHttpRequest;\n    }\n\n    if(typeof console === \"undefined\"){\n        let console = eval('require(\\'console\\')');\n    }\n    let document = undefined;\n}\nelse{\n    let WebSocket = window.WebSocket;\n    let XMLHttpRequest = window.XMLHttpRequest;\n    let console = window.console;\n    let document = window.document;\n}\n\n// Check dependencies\nif(typeof WebSocket !== \"undefined\"){\n    if(!msgpack) throw new DependencyError(\"This library requires msgpack-lite\");\n    if(!UUID) throw new DependencyError(\"This library requires pure-uuid\");\n}\nif(typeof XMLHttpRequest === \"undefined\") throw new DependencyError(\"This library requires XMLHttpRequest\");\nif(typeof console === \"undefined\") throw new DependencyError(\"This library requires console\");\n\n// Helpers\n\nlet send_data_to_subscribers = function(socket_subject_map, stream, data){\n    if(stream in socket_subject_map){\n        for(let i = 0; i < socket_subject_map[stream].length; i++){\n            socket_subject_map[stream][i].next(data);\n        }\n    }\n};\n\nlet return_http_response = function(event, callback){\n    let request_response;\n    let request_response_code = event.target.status;\n\n    try {\n        request_response = JSON.parse(event.target.response);\n    } catch(e) {\n        if(e instanceof SyntaxError){\n            console.error(\"Cannot parse HTTP response JSON\", event.target.response);\n            return;\n        }else{\n            throw e;\n        }\n    }\n    callback(request_response_code, request_response);\n};\n\n// Core logic\n\nlet init_socket = function(ws_url, socket_connection){\n    let self = this;\n    socket_connection.socket = new WebSocket(ws_url);\n    socket_connection.socket.binaryType = \"arraybuffer\";\n    socket_connection.socket.onmessage = function(ev) {\n        if(ev && ev.data){\n            let data;\n            try {\n                let decoded_response = msgpack.decode(new Uint8Array(ev.data));\n                console.log(\"WS receiving (raw)...\", decoded_response);\n                data = JSON.parse(decoded_response);\n                console.log(\"WS receiving (parsed)...\", data);\n\n                if (!data || !data.stream || !data.payload){\n                    // Data parsed but does not fit pattern\n                    console.error(\"socket message does not match expected pattern. message:\" + JSON.stringify(data));\n                    return;\n                }\n            } catch(e) {\n                if(e instanceof SyntaxError){\n                    // Can't parse the data\n                    console.error(\"Cannot parse WS response JSON\");\n                }else{\n                    console.error(e);\n                }\n                return;\n            }\n\n            if(!!data.payload){\n                let request_response = data.payload.data;\n                let request_response_code = data.payload.response_status;\n\n                if(!!request_response && !!request_response_code){\n                    // Both the status code and the data must be present in the response for it to trigger its corresponding callback\n                    if (data.payload.request_id in socket_connection.router) {\n                        socket_connection.router[data.payload.request_id][\"callback\"](request_response_code, request_response);\n                        delete socket_connection.router[data.payload.request_id];\n                    }\n                }\n            }\n\n            send_data_to_subscribers(socket_connection.subject_map, \"*\", data);\n            send_data_to_subscribers(socket_connection.subject_map, data.stream, data);\n        }\n    };\n\n    socket_connection.socket.onopen = function() {\n        socket_connection.in_progress = false;\n        let element = null;\n\n        while(element = socket_connection.queue.shift()){\n            socket_send(ws_url, socket_connection, element);\n        }\n    };\n};\n\nlet socket_send = function(ws_url, socket_connection, message, callback){\n    let queue_and_reconnect = false;\n\n    // If there is a callback on this request and it has no id, register the callback to the socket router\n    // There is no need to re-register the callback once it has been registered, so this request can be repeated\n    // without its callback if it cannot be sent initially.\n    if (!!callback && !message.payload.request_id){\n        message.payload.request_id = (new UUID(4)).format();\n\n        socket_connection.router[message.payload.request_id] = {\"time\": new Date().getTime(), \"callback\": callback};\n    }\n\n    if(\n        socket_connection.socket === null ||\n        socket_connection.socket.readyState === socket_connection.socket.CONNECTING ||\n        socket_connection.socket.readyState === socket_connection.socket.CLOSED\n    ){\n        queue_and_reconnect = true;\n    }\n\n    if(queue_and_reconnect){\n        socket_connection.queue.push(message);\n\n        if(!socket_connection.in_progress){\n            init_socket(ws_url, socket_connection);\n            socket_connection.in_progress = true;\n        }\n\n        return;\n    }\n\n    console.log(\"WS sending...\", message);\n    socket_connection.socket.send( msgpack.encode(message) );\n};\n\nlet http_transport_func = function(protocol_prefix, method, api_url, endpoint, id, custom_method, query_params, data, headers, with_credentials, callback, socket_connection){\n    let request = new XMLHttpRequest();\n\n    let id_block = \"\";\n    if(!!id) id_block = \"/\"+encodeURIComponent(id);\n\n    let custom_method_block = \"\";\n    if(!!custom_method) custom_method_block = encodeURIComponent(custom_method)+\"/\";\n\n    let query_param_block = \"\";\n    if(!!query_params && query_params instanceof Object){\n      query_param_block = \"?\";\n\n      for(let query_param in query_params){\n          query_param_block += encodeURIComponent(query_param) + \"=\" + encodeURIComponent(query_params[query_param]) + \"&\";\n      }\n\n      // Take off last & sign\n      query_param_block = query_param_block.slice(0, -1);\n    }\n\n    let url = protocol_prefix + api_url + endpoint + id_block + \"/\" + custom_method_block + query_param_block;\n\n    console.log(\"Sending http request to url: \", url);\n\n    request.open(method, url, true);\n\n    request.setRequestHeader(\"Content-Type\", \"application/json\");\n\n    for(let header in headers){\n        request.setRequestHeader(header, headers[header]);\n    }\n\n    if(!!with_credentials){\n        request.withCredentials = true;\n    }\n\n    if(!!callback){\n        request.onload = function(event){\n            return_http_response(event, callback);\n        };\n        request.onerror = function(event){\n            return_http_response(event, callback);\n        };\n        request.onabort = function(event){\n            return_http_response(event, callback);\n        };\n        request.ontimeout = function(event){\n            return_http_response(event, callback);\n        };\n    }\n\n    request.send(JSON.stringify(data));\n};\n\nlet ws_transport_func = function(protocol_prefix, method, api_url, endpoint, id, custom_method, query_params, data, headers, with_credentials, callback, socket_connection){\n    let payload = {\n        \"method\": method\n    };\n\n    if(!!custom_method) payload[\"action\"] = custom_method;\n\n    if(!!id) payload[\"pk\"] = id;\n\n    if(!!query_params) payload[\"query_params\"] = query_params;\n\n    if(!!data) payload[\"data\"] = data;\n\n    socket_send(protocol_prefix + api_url, socket_connection, {\n        \"stream\": endpoint,\n        \"payload\": payload\n    }, callback);\n}\n\nlet transport_funcs = {\n    \"http\": function(){\n        http_transport_func.prototype.constructor.apply(this, [\"http://\"].concat(Array.prototype.slice.call(arguments)));\n    },\n    \"https\": function(){\n        http_transport_func.prototype.constructor.apply(this, [\"https://\"].concat(Array.prototype.slice.call(arguments)));\n    },\n    \"websocket_msgpack\": function(){\n        ws_transport_func.prototype.constructor.apply(this, [\"ws://\"].concat(Array.prototype.slice.call(arguments)));\n    },\n    \"websocket_msgpack_secure\": function(){\n        ws_transport_func.prototype.constructor.apply(this, [\"wss://\"].concat(Array.prototype.slice.call(arguments)));\n    }\n};\n\n// Api definition\n// Transport types in order of increasing priority\nlet transport_types = [\"http\", \"https\", \"websocket_msgpack\", \"websocket_msgpack_secure\"];\n\n//NetworkTransport Class initialized per-connection\n\nexport class NetworkTransport {\n\n    constructor(api_url, transports, garbage_collect_timeout) {\n        // Core\n        this.socket_connection = {\n            \"socket\": null,\n            \"in_progress\": false,\n            \"queue\": [],\n            \"router\": {},\n            // rxjs subject map which maps endpoints to subjects\n            \"subject_map\": {}\n        };\n        // The host to connect to\n        this.api_url = api_url;\n        // Delete callbacks older than a certain amount of time (60 seconds default)\n        this.garbage_collect_timeout = garbage_collect_timeout || 60000;\n        if(typeof this.api_url !== \"string\") throw new APIError(\"api_url must be a string.\");\n        // Allowed transports: http, websocket\n        this.transports = transports;\n        if(!(this.transports instanceof Array)) throw new APIError(\"transports must be an array.\");\n        if(this.transports.length == 0) this.transports = [\"http\"];\n        for(let i = 0; i < this.transports.length; i++){\n            if(transport_types.indexOf(this.transports[i]) === -1) throw new APIError(this.transports[i]+\" is not a supported transport.\");\n        }\n        // Remove websockets as a transport if they are not supported\n        let ws_index = this.transports.indexOf(\"websocket_msgpack\");\n        if(ws_index !== -1){\n            if(!WebSocket){\n                this.transports.splice(ws_index, 1);\n                console.warn(\"not using websockets because they are not supported.\");\n            }\n        }\n        let wss_index = this.transports.indexOf(\"websocket_msgpack_secure\");\n        if(wss_index !== -1){\n            if(!WebSocket){\n                this.transports.splice(wss_index, 1);\n                console.warn(\"not using secure websockets because they are not supported.\");\n            }\n        }\n        // Start garbage collection\n        this.garbage_collect();\n    }\n\n    /*\n    Submit a request containing the following\n    {\n        \"method\": <REST method> (default: GET)\n        \"endpoint\": <REST endpoint> (required)\n        \"id\": <resource id> (optional)\n        \"custom_method\": <endpoint custom method> (optional)\n        \"query_params\": <map of query params to attach to url> (optional)\n        \"data\": <data to send with request> (optional)\n        \"headers\" <headers to send with request> (optional)\n        \"with_credentials\" <use cookies in request, currently applies to http-type requests only> (default: true)\n        \"force_transport\" <force a transport layer> (optional)\n    }\n    also submit a callback if you need a response\n    */\n    send(request, callback){\n        if(!request) throw new APIError(\"request is not defined or blank.\");\n        if(!(\"endpoint\" in request)) throw new APIError(\"request must contain endpoint.\");\n\n        // Determine the transport to use\n        let transport = request[\"force_transport\"];\n\n        if(!transport){\n        // Pick the most important transport (the last one on the list)\n        transport = this.transports[this.transports.length-1];\n        }\n\n        if(this.transports.indexOf(transport) === -1) throw new APIError(transport+\" is not an active transport.\");\n\n        // Transport-specific issues\n        if(transport === \"websocket_msgpack\" && !!request[\"headers\"]) console.warn(\"websocket transport does not support headers.\");\n\n        // Call transport function\n        transport_funcs[transport](\n            request[\"method\"] || \"GET\",\n            this.api_url,\n            request[\"endpoint\"],\n            request[\"id\"],\n            request[\"custom_method\"],\n            request[\"query_params\"],\n            request[\"data\"],\n            request[\"headers\"],\n            request[\"with_credentials\"] || true,\n            callback,\n            this.socket_connection\n        );\n    }\n\n    // Subscribe a given subject to a given endpoint. Special \"*\" wildcard subscribes to all endpoints.\n    subscribe_endpoint(endpoint, socket_subject){\n        if(!(endpoint in this.socket_connection.subject_map)) this.socket_connection.subject_map[endpoint] = [];\n\n        if(this.socket_connection.subject_map[endpoint].indexOf(socket_subject) !== -1) return;\n\n        this.socket_connection.subject_map[endpoint].push(socket_subject);\n    }\n\n    garbage_collect(){\n        let self = this;\n        console.log(\"garbage collection started...\");\n        let now = new Date().getTime();\n        for(let request_id in this.socket_connection.router){\n            if(now - this.socket_connection.router[request_id][\"time\"] > this.garbage_collect_timeout){\n                delete this.socket_connection.router[request_id];\n                console.log(\"garbage collected request callback \", request_id);\n            }\n        }\n        console.log(\"garbage collection ended.\");\n        setTimeout(function(){\n            self.garbage_collect();\n        }, this.garbage_collect_timeout);\n    }\n\n    //From http://stackoverflow.com/questions/5639346/what-is-the-shortest-function-for-reading-a-cookie-by-name-in-javascript\n    //Using dynamic version because cookies may be changed via API calls\n    read_cookie(name) {\n        if(typeof document === \"undefined\" || typeof document.cookie === \"undefined\") throw new APIError(\"Current context has no cookies\");\n        var nameEQ = name + \"=\";\n        var ca = document.cookie.split(';');\n        for(var i=0;i < ca.length;i++) {\n            var c = ca[i];\n            while (c.charAt(0)==' ') c = c.substring(1,c.length);\n            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n        }\n        return null;\n    }\n\n}\n\nexport default class Library {\n    constructor(api_url, transports) {\n        this._name = 'network_transport';\n    }\n\n    get name() {\n        return this._name;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}